I don't think that really helps. Maybe somebody passed a unix domain socket around, and now we're crediting the wrong socket again. So how about we actually add a "struct cred *" to the scm_cookie itself, and we initialize it to "get_current_cred()". And then always use that. That way it's always the person who actually does the send (rather than the opener of the socket _or_ the opener of the file that gets passed around) that gets credited, and thanks to the cred pointer we can then de-credit them properly. Hmm?